<!doctype html>
<html lang="en-us">
  <head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script>
    <title>Oh, Python is slow? // a dystopian journey into the heart of tech</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.132.1">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Pruthvi Kumar" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/blog/css/main.min.5b1fcc8902588589c4767187402a3c29f8b8d7a6fdef6d9f8f77045bb0d14fee.css" />

    
      
      <link rel="stylesheet" href="/blog/css/custom.min.25783b96a2de994990c45f6d25ecb8574e511f6ec4f3fa548c53e7ec99e08a66.css" />
    

    

    
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-0Q0C7S8K6Z"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-0Q0C7S8K6Z');
        }
      </script>
    
  


    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Oh, Python is slow?">
  <meta name="twitter:description" content="Sure, keep blaming the language like the rest of the herd ‚Äî But if your code‚Äôs leaky and crawling, Spoiler: it‚Äôs you, not the languageüòè
Ah, another day, another developer blaming Python for their code‚Äôs sluggish performance. üêå Before you join the chorus of the uninformed, let‚Äôs embark on a journey through the labyrinthine world of Python‚Äôs memory management.
The Architect‚Äôs Dilemma: Designing a Programming Language Ever fantasized about creating your own programming language?">

    <meta property="og:url" content="http://localhost:1313/blog/posts/memory-in-python/">
  <meta property="og:site_name" content="a dystopian journey into the heart of tech">
  <meta property="og:title" content="Oh, Python is slow?">
  <meta property="og:description" content="Sure, keep blaming the language like the rest of the herd ‚Äî But if your code‚Äôs leaky and crawling, Spoiler: it‚Äôs you, not the languageüòè
Ah, another day, another developer blaming Python for their code‚Äôs sluggish performance. üêå Before you join the chorus of the uninformed, let‚Äôs embark on a journey through the labyrinthine world of Python‚Äôs memory management.
The Architect‚Äôs Dilemma: Designing a Programming Language Ever fantasized about creating your own programming language?">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-14T12:19:45+10:00">
    <meta property="article:modified_time" content="2024-04-14T12:19:45+10:00">


    
    <script src="https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        mermaid.initialize({
          startOnLoad: true,
          theme: 'default',
          themeVariables: {
            background: '#f4f4f4',
            primaryColor: '#007bff',
            secondaryColor: '#6c757d',
            tertiaryColor: '#28a745',
            primaryTextColor: '#212529',
            secondaryTextColor: '#495057',
            tertiaryTextColor: '#ffffff',
            lineColor: '#999999',
            fontSize: '16px'
          }
        });
      });
    </script>
  </head>
  <body>
    <header class="app-header">
      <a href="http://localhost:1313/blog/"><img class="app-header-avatar" src="/blog/avatar.jpg" alt="Pruthvi Kumar" /></a>
      <span class="app-header-title">a dystopian journey into the heart of tech</span>
      <p>confessions of a serial key puncher: the life and times of a coder.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/1x-eng" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>GitHub</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://au.linkedin.com/in/iampruthvi" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>Linkedin</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg>
          </a>
        
          <a href="https://stackoverflow.com/users/10019687/pruthvi-kumar" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-layers">
  <title>Stackoverflow</title>
  <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Oh, Python is slow?</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Apr 14, 2024
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          9 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>Sure, keep blaming the language like the rest of the herd ‚Äî But if your code‚Äôs leaky and crawling, Spoiler: it‚Äôs you, not the languageüòè</p>
<p>Ah, another day, another developer blaming Python for their code&rsquo;s sluggish performance. üêå Before you join the chorus of the uninformed, let&rsquo;s embark on a journey through the labyrinthine world of Python&rsquo;s memory management.</p>
<h2 id="the-architects-dilemma-designing-a-programming-language">The Architect&rsquo;s Dilemma: Designing a Programming Language</h2>
<p>Ever fantasized about creating your own programming language? Imagine having the power to decide how memory management works. Sounds thrilling, right? Or maybe just terrifying. It‚Äôs not just about keeping things simple or making them complex. Nope, it‚Äôs a constant tug-of-war between:</p>
<ul>
<li>Keeping interfaces idiot-proof</li>
<li>Making sure it works on everything</li>
<li>Balancing speed with not crashing all the time</li>
</ul>
<p>The brains behind Python have done most of the heavy lifting for you, so you don‚Äôt have to think too hard. But they‚Äôve also left some decisions in the hands of the average coder. The real question is: how many even know what choices they&rsquo;re making? And of those, how many are actually getting it right? Welcome to the can of worms you just opened.</p>
<h2 id="peering-under-the-hood-cpythons-memory-allocation">Peering Under the Hood: CPython&rsquo;s Memory Allocation</h2>
<p>Time to roll up our sleeves and check out what‚Äôs under CPython‚Äôs hood. Curious how memory allocation works in C‚Äôs engine room? Meet the trio running the show:</p>
<ol>
<li><strong>Static memory allocation</strong>: The old-school, rock-solid type.</li>
<li><strong>Automatic memory allocation</strong>: The reliable workhorse, always on duty.</li>
<li><strong>Dynamic memory allocation</strong>: The nimble gymnast, ready to adapt on the fly.</li>
</ol>
<div class="mermaid">graph TD
    A[Memory Allocation in C] --> B[Static]
    A --> C[Automatic]
    A --> D[Dynamic]
    B --> E[Fixed size at compile time]
    C --> F[Stack-based, auto cleanup]
    D --> G[Heap-based, manual management]
</div><p>CPython, built on C&rsquo;s rigid foundation, has its own set of hurdles. But things get interesting when Python‚Äôs design philosophy starts throwing wrenches into the mix:</p>
<ul>
<li><strong>Dynamically typed</strong>: Size? Who cares? We‚Äôll figure it out when we get there.</li>
<li><strong>Dynamically sized core types</strong>: Lists, dictionaries, even integers ‚Äì none of them have any clue about limits.</li>
<li><strong>Names as shape-shifters</strong>: <code>some_value</code> could be anything ‚Äì an integer, a string, or even a list. It‚Äôs like Python‚Äôs version of a wild card.</li>
</ul>
<p>To manage this circus, CPython relies heavily on dynamic memory allocation. But don‚Äôt worry, it‚Äôs not as reckless as it sounds. Python added some fancy safety nets: garbage collection and reference counting. It‚Äôs like Python decided to handle the boring memory stuff for you. How thoughtful. (is this thanked enough, though?)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Example of dynamic typing and its impact on memory</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Initially an integer</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;x is an integer: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, Size: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">()</span><span class="si">}</span><span class="s2"> bytes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="s2">&#34;Hello&#34;</span>  <span class="c1"># Now a string</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;x is now a string: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, Size: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">()</span><span class="si">}</span><span class="s2"> bytes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># Now a list</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;x is now a list: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, Size: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">()</span><span class="si">}</span><span class="s2"> bytes&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="the-triad-of-allocation-domains">The Triad of Allocation Domains</h2>
<p>Check out the three realms of memory allocation, each with its own gig:</p>
<ol>
<li><strong>The Raw Domain</strong>: For when you want to dive straight into system heap and manage big, non-object-related memory. Not for the faint-hearted.</li>
<li><strong>The Object Domain</strong>: Where Python objects hang out, blissfully ignorant of the underlying mess.</li>
<li><strong>The PyMem Domain</strong>: A throwback for those still using legacy APIs and penning letters by candlelight.</li>
</ol>
<p>CPython uses two types of allocators:</p>
<ul>
<li><strong><code>malloc</code></strong>: The OS&rsquo;s basic tool for raw memory.</li>
<li><strong><code>pymalloc</code></strong>: Python‚Äôs custom allocator, designed for the PyMem and Object domains.</li>
</ul>
<p>CPython&rsquo;s memory allocator, perched on top of <code>malloc</code> like a picky bird, has its own quirks:</p>
<ul>
<li>Most requests are small and fixed-size. PyObject? Just 16 bytes. PyASCIIObject? A lean 42 bytes. PyLongObject? A hefty 32 bytes.</li>
<li><code>pymalloc</code> handles blocks up to 256 KB. Larger chunks? They‚Äôre sent to <code>malloc</code>.</li>
<li>Thread safety? Not needed with the GIL in play. <code>pymalloc</code> is like, ‚ÄúI‚Äôm good!‚Äù</li>
</ul>
<div class="mermaid">graph TD
    A[Memory Allocation Request] --> B{Size > 256 KB?}
    B -->|Yes| C[Raw Domain]
    B -->|No| D{Is it a Python Object?}
    D -->|Yes| E[Object Domain]
    D -->|No| F[PyMem Domain]
    C --> G[malloc]
    E --> H[pymalloc]
    F --> H
</div><h2 id="the-holy-trinity-blocks-pools-and-arenas">The Holy Trinity: Blocks, Pools, and Arenas</h2>
<div class="mermaid">graph TD
    A[Arena 256KB] --> B[Pool]
    B --> C[Block]
    B --> D[Block]
    B --> E[Block]
    A --> F[Pool]
    F --> G[Block]
    F --> H[Block]
    I[Central Register] --> J[Tracks available blocks]
    I --> K[Manages pool usage]
</div><p>Blocks, the basic memory units, gather in pools. Pools are then grouped into arenas. It‚Äôs a bureaucratic dance of efficiency that would make any office manager proud.</p>
<p>A central register, like a know-it-all librarian, keeps track of block locations and availability within each pool. When a pool runs out of space, the next one in line picks up the slack.</p>
<h3 id="arenas-the-grand-ballrooms-of-memory">Arenas: The Grand Ballrooms of Memory</h3>
<p>Arenas, the big shots of memory grouping, are a hefty 256KB to match the system page size. Why? Because contiguous memory is faster than fragmented memory. It‚Äôs a nice theory, but how many developers actually care? I‚Äôm not counting on it.</p>
<p>Arenas are strung together in a doubly linked list within the arena data structure, using <code>nextarena</code> and <code>prevarena</code> pointers. It‚Äôs like a conga line of memory‚Äîminus the fun and dancing.</p>
<h3 id="pools-the-social-clubs-of-memory-blocks">Pools: The Social Clubs of Memory Blocks</h3>
<p>Inside an arena, pools are created for block sizes up to 512 bytes, like a just-in-time memory buffet. If no pools are available for a requested size, a new one is added. Arenas keep track of pool creation with a high water mark.</p>
<p>Pools come in three types: Full, Used, and Empty. It‚Äôs like a memory nightclub‚Äîsome are packed, some have space, and some are just waiting for action.</p>
<p>Each pool has a doubly linked list to other pools of its class, like a social network for memory blocks‚Äîthey always know where their buddies are.</p>
<h3 id="blocks-the-individual-dancers-in-the-memory-ballet">Blocks: The Individual Dancers in the Memory Ballet</h3>
<p>In a pool, memory is chopped up into fixed-size blocks, allocated and freed with the precision of a seasoned choreographer. Available blocks are tracked in a singly linked list called <code>freeblock</code>.</p>
<p>When a block is freed, it‚Äôs shoved to the front of the <code>freeblock</code> list‚Äîlike cutting in line, but perfectly acceptable in the realm of memory management.</p>
<h2 id="the-object-and-pymem-memory-allocation-domains">The Object and PyMem Memory Allocation Domains</h2>
<p>The object memory allocator is the VIP lounge of the memory world, handling Python objects like dictionary keys and list items. It‚Äôs also the backstage pass for the compiler, AST, parser, and evaluation loop‚Äîwhere the real Python magic happens.</p>
<p>For those feeling rebellious and wanting to ditch the default strategy, you can create custom domain allocators or memory allocation sanitizers. But be warned: this isn‚Äôt for the faint of heart or the code-impaired. Know what you‚Äôre doing before you dive into this high-stakes game.</p>
<h2 id="reference-counting-your-personal-memory-butler">Reference Counting: Your Personal Memory Butler</h2>
<p>Now, let‚Äôs chat about reference counting‚Äîthe unsung hero of Python‚Äôs memory management. It‚Äôs like having a butler who actually does their job, keeping track of your stuff and making sure it‚Äôs cleaned up properly.</p>
<div class="mermaid">sequenceDiagram
    participant V as Variable
    participant O as Object
    participant RC as Reference Count
    V->>O: Assign value
    O->>RC: Increment count
    V->>O: Reassign value
    O->>RC: Decrement count
    RC->>O: Count = 0
    O->>Memory: Free memory
</div><p>Every time you create an object, Python starts counting references‚Äîno, not your coding blunders (that‚Äôd be endless), but references to the object. When you assign a value to a variable, Python checks <code>locals()</code> and <code>globals()</code>, creates a new object if needed, and updates the relevant dictionary.</p>
<p>In CPython‚Äôs C source code, you‚Äôll find <code>Py_INCREF()</code> and <code>Py_DECREF()</code> macros. These are the main tools for bumping up or down the reference count. It‚Äôs like a very dull, but crucial, game of ping pong.</p>
<p>This example demonstrates how Python keeps track of references and adjusts the count as references are added or removed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create a list</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Reference count for &#39;a&#39;: </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">getrefcount</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create another reference to the same list</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Reference count after &#39;b = a&#39;: </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">getrefcount</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Remove one reference</span>
</span></span><span class="line"><span class="cl"><span class="k">del</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Reference count after &#39;del b&#39;: </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">getrefcount</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="garbage-collection-because-some-people-cant-clean-up-after-themselves">Garbage Collection: Because Some People Can&rsquo;t Clean Up After Themselves</h2>
<div class="mermaid">graph TD
    A[Create Objects] --> B[Objects Reference Each Other]
    B --> C[Delete External References]
    C --> D[Reference Count > 0]
    D --> E[Garbage Collector Runs]
    E --> F[Detect Circular References]
    F --> G[Break Cycles]
    G --> H[Free Memory]
</div><p>But what about those pesky circular references? You know, like when you do something silly like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">del</span> <span class="n">x</span>
</span></span></code></pre></div><p>The reference count for <code>x</code> is still 1 because it referred to itself. It&rsquo;s like a snake eating its own tail, but less mythological and more annoying.</p>
<p>Enter the garbage collector‚ÄîPython‚Äôs way of saying, ‚ÄúAlright, I‚Äôll handle it.‚Äù It cleans up memory from objects that have outlived their usefulness. Enabled by default, it works in the background like a spectral janitor, tidying up without making a fuss.</p>
<div class="mermaid">graph TD
    A[Start GC] --> B[Find Unreachable Objects]
    B --> C[Mark as Garbage]
    C --> D[Free Memory]
    D --> E[Reset Counters]
    E --> F[End GC]
</div><p>The garbage collector doesn‚Äôt run constantly‚Äîbecause that‚Äôd be a CPU nightmare. Instead, it kicks in periodically after a certain number of operations. It‚Äôs like taking out the trash: you don‚Äôt do it every five minutes, but you also don‚Äôt wait until your place is buried in garbage.</p>
<p>And here&rsquo;s a concrete example of a circular reference: This example creates a circular reference that reference counting alone can&rsquo;t handle, demonstrating the need for garbage collection.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create a circular reference</span>
</span></span><span class="line"><span class="cl"><span class="n">node1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&#34;Node 1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">node2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&#34;Node 2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">node1</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">node2</span>
</span></span><span class="line"><span class="cl"><span class="n">node2</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">node1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Remove references to the nodes</span>
</span></span><span class="line"><span class="cl"><span class="k">del</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Force garbage collection</span>
</span></span><span class="line"><span class="cl"><span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Garbage collector collected </span><span class="si">{</span><span class="n">gc</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span><span class="si">}</span><span class="s2"> objects&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="generational-garbage-collection-because-even-trash-has-a-lifecycle">Generational Garbage Collection: Because Even Trash Has a Lifecycle</h2>
<p>Python‚Äôs garbage collector uses generational garbage collection, based on the idea that most objects are short-lived. Like mayflies, but for memory.</p>
<p>CPython‚Äôs collector has three generations, each with its own threshold for when to clean up. It‚Äôs like a trash lifecycle‚Äîstarting with fresh garbage and eventually dealing with vintage refuse.</p>
<div class="mermaid">graph TD
    A[New Objects] --> B[Generation 0]
    B -->|Survive Collection| C[Generation 1]
    C -->|Survive Collection| D[Generation 2]
    B -->|Collected| E[Freed Memory]
    C -->|Collected| E
    D -->|Collected| E
</div><p>An example demonstrating generations GC:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create some objects</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="s2">&#34;Hello, World!&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;value&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check garbage collection counts</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;GC counts before collection: </span><span class="si">{</span><span class="n">gc</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Force a collection</span>
</span></span><span class="line"><span class="cl"><span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;GC counts after collection: </span><span class="si">{</span><span class="n">gc</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create more objects</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;GC counts after creating many objects: </span><span class="si">{</span><span class="n">gc</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="in-conclusion-a-mirror-for-the-masses">In Conclusion: A Mirror for the Masses</h2>
<p>So, next time you‚Äôre tempted to complain about Python‚Äôs performance, maybe take a moment for some self-reflection. Is it really Python that‚Äôs slow, or could it be that the fault lies not in the stars, but in ourselves?</p>
<p>Python has made a heroic effort to simplify memory management. If your code still runs like a sloth in molasses, it might be time to look in the mirror and ask if the problem is right in front of the keyboard.</p>
<p>Remember, a poor craftsman blames their tools. In Python‚Äôs world, that tool is often sharper than its user. So before you proclaim, ‚ÄúPython is slow,‚Äù ask yourself: Are you truly justified in casting that stone, or should you be hitting the books instead of bashing Python? ü§îüíª</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
